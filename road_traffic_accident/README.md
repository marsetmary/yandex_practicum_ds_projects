# Предсказание риска ДТП в каршеринге

**Цель проекта:** создать модель для оценки вероятности попадания водителя в ДТП на основе выбранного маршрута и характеристик водителя и автомобиля.

---

## Задачи проекта
- Загрузка таблиц из SQL и первичный анализ данных  
- Статистический анализ факторов, влияющих на ДТП  
- Подготовка данных и отбор значимых признаков  
- Обучение и сравнение нескольких моделей  
- Выбор лучшей модели и проверка её работы на тестовых данных

---

## Основные результаты
- **Лучшая модель:** XGBClassifier(n_estimators=190, max_depth=4, learning_rate=0.049)  
- **Метрики на тесте:** ROC-AUC = 0.6864, F1 = 0.6290  
- **Наиболее значимый фактор:** тип кузова (vehicle_type) — водители седанов имеют почти в 2,5 раза меньшую вероятность быть виновными в ДТП

---

## Выводы
- Модель способна эффективно ранжировать водителей по уровню риска даже на ограниченном наборе признаков  
- Система может быть использована для предупреждений водителей и динамического управления рисками в каршеринге или страховании  
- Для повышения точности рекомендуется добавить признаки: история нарушений ПДД, усталость водителя, состояние в реальном времени, погодные условия, поведение при аренде, данные с датчиков автомобиля

---
## Используемые библиотеки
pandas, numpy, matplotlib, seaborn, sklearn, xgboost, lightgbm, optuna, category_encoders, phik, sqlalchemy
